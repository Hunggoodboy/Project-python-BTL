<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Quản lý đơn hàng</title>
<style>
    body { font-family: 'Roboto', sans-serif; padding: 20px; }
    .order-row { display: flex; align-items: center; border-bottom: 1px solid #ddd; padding: 15px 0; }
    .order-row img { height: 100px; width: 100px; margin-right: 20px; }
    .order-info { flex: 1; }
    .order-info div { margin-bottom: 5px; }
    .status { cursor: pointer; font-weight: bold; margin-right: 10px; }
    .status.green { color: green; }
    .status.yellow { color: goldenrod; }
    .cancel-btn { padding: 5px 10px; cursor: pointer; }
    .modal { display: none; position: fixed; z-index: 999; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.5); }
    .modal-content { background-color: #fefefe; margin: 10% auto; padding: 20px; border: 1px solid #888; width: 50%; position: relative; }
    .close { color: #aaa; float: right; font-size: 28px; cursor: pointer; }
</style>
</head>
<body>
<h1>Quản lý đơn hàng</h1>

<div id="orders-container">
    {% for order in rows %}
    <div class="order-row" id="order-{{ order.MaDH }}">
        <img src="{{ url_for('static', filename=order.HinhAnh) }}" alt="{{ order.TenSP }}">
        <div class="order-info">
            <div><strong>{{ order.TenSP }}</strong></div>
            <div>Giá: {{ order.TongGia }}₫</div>
            <div>Số lượng: {{ order.SoLuong }}</div>
        </div>
        <div>
            <span class="status {% if order.TrangThai == 'Đã giao thành công' %}green{% else %}yellow{% endif %}" onclick="openStatusModal({{ order.MaDH }})">{{ order.TrangThai }}</span>
            <!-- {% if order.TrangThai == 'Chờ xác nhận đơn' %}
                <button class="cancel-btn" onclick="openCancelModal({{ order.MaDH }})">Hủy đơn</button>
            {% elif order.TrangThai == 'Chờ bạn xác nhận' %}
                <button class="confirm-order-btn" onclick="confirmOrder({{ order.MaDH }}, '{{ order.MaSP }}')">Xác nhận giao thành công</button>
            {% endif %}
            {% if order.TrangThai == 'Đã giao thành công' %}
            <button class="review-btn" onclick="openReviewModal({{ order.MaDH }}, '{{ order.ProductID }}')">Đánh giá</button>
            {% endif %} -->
        </div>
    </div>
    {% endfor %}
</div>

<!-- Chi tiết các trạng thái của đơn -->
{% for order in orders %}
<div id="status-modal-{{ order.id }}" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal('status', {{ order.MaDH }})">&times;</span>
        <h2>Chi tiết trạng thái đơn hàng</h2>
        <p>Thông tin chi tiết sẽ hiển thị ở đây...</p>
    </div>
</div>
{% endfor %}
<script>
function openStatusModal(id) {
    document.getElementById('status-modal-' + id).style.display = 'block';
}
function closeModal(type, id) {
    document.getElementById(type + '-modal-' + id).style.display = 'none';
}
</script>
</body>
</html>